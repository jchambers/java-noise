<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) on Sun Mar 03 12:08:44 EST 2024 -->
<title>NoiseHandshake (java-noise 0.0.0-SNAPSHOT API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2024-03-03">
<meta name="description" content="declaration: package: com.eatthepath.noise, class: NoiseHandshake">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/NoiseHandshake.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li><a href="#nested-class-summary">Nested</a></li>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">com.eatthepath.noise</a></div>
<h1 title="Class NoiseHandshake" class="title">Class NoiseHandshake</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">com.eatthepath.noise.NoiseHandshake</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">NoiseHandshake</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block"><p>A <code>NoiseHandshake</code> instance is responsible for encrypting and decrypting the messages that comprise a Noise
 handshake. Once a Noise handshake instance has finished exchanging handshake messages, it can produce a Noise
 transport object for steady-state encryption and decryption of Noise transport messages.</p>

 <p>Noise handshake messages contain key material and an optional payload. The security properties for the optional
 payload vary by handshake pattern, message, and sender role. Callers are responsible for verifying that the security
 properties associated with ny handshake message are suitable for their use case. Please see
 <a href="https://noiseprotocol.org/noise.html#payload-security-properties">The Noise Protocol Framework - Payload
 security properties</a> for a complete explanation.</p>

 <p>Generally speaking, the initiator and responder alternate sending and receiving messages until all messages in the
 handshake pattern have been exchanged. At that point, callers transform (or "split" in the terminology of the Noise
 Protocol Framework specification) the Noise handshake into a Noise transport instance appropriate for the handshake
 type (i.e. one-way or interactive) and pass Noise transport messages between the initiator and responder as
 needed.</p>

 <p>Noise handshake instances are stateful and are <em>not</em> thread-safe.</p>

 <h2 id="interactive-patterns-heading">Interactive patterns</h2>

 <p>In the most common case, Noise handshakes implement a interactive pattern in which both parties will send and
 receive messages to one another once the handshake is complete. As an example, the NN interactive handshake pattern
 is defined as:</p>

 <pre>NN:
   -&gt; e
   &lt;- e, ee</pre>

 <p>The parties in an NN handshake exchange messages until all required messages have been exchanged, then the
 handshake instances yield interactive transport instances:</p>

 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">final NoiseHandshake initiatorHandshake = NoiseHandshakeBuilder.forNNInitiator()
    .setComponentsFromProtocolName("Noise_NN_25519_AESGCM_SHA256")
    .build();

final NoiseHandshake responderHandshake = NoiseHandshakeBuilder.forNNResponder()
    .setComponentsFromProtocolName("Noise_NN_25519_AESGCM_SHA256")
    .build();

// -&gt; e (with an empty payload)
final byte[] initiatorEMessage = initiatorHandshake.writeMessage((byte[]) null);
responderHandshake.readMessage(initiatorEMessage);

// &lt;- e, ee (with an empty payload)
final byte[] responderEEeMessage = responderHandshake.writeMessage((byte[]) null);
initiatorHandshake.readMessage(responderEEeMessage);

assert initiatorHandshake.isDone();
assert responderHandshake.isDone();

final NoiseTransport initiatorTransport = initiatorHandshake.toTransport();
final NoiseTransport responderTransport = responderHandshake.toTransport();
</code></pre>
</div>


 <h2 id="one-way-patterns-heading">One-way patterns</h2>

 <p>Noise handshakes may also use one-way patterns. As the Noise Protocol Framework specification notes:</p>

 <blockquote>These patterns could be used to encrypt files, database records, or other non-interactive data
 streams.</blockquote>

 <p>One-way handshakes exchange handshake messages in the same way as interactive handshakes, but instead of
 producing interactive <a href="NoiseTransport.html" title="interface in com.eatthepath.noise"><code>NoiseTransport</code></a> instances, one-way handshakes produce a one-way
 <a href="NoiseTransportWriter.html" title="interface in com.eatthepath.noise"><code>NoiseTransportWriter</code></a> for initiators or <a href="NoiseTransportReader.html" title="interface in com.eatthepath.noise"><code>NoiseTransportReader</code></a> for responders. As an example, the N
 handshake pattern is defined as:</p>

 <pre>N:
   &lt;- s
   ...
   -&gt; e, es</pre>

 <p>The parties in an N handshake exchange messages as usual, then the handshake instances yield one-way transport
 instances:</p>

 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">final NoiseHandshake initiatorHandshake = NoiseHandshakeBuilder.forNInitiator(responderStaticPublicKey)
    .setComponentsFromProtocolName("Noise_N_25519_AESGCM_SHA256")
    .build();

final NoiseHandshake responderHandshake = NoiseHandshakeBuilder.forNResponder(responderStaticKeyPair)
    .setComponentsFromProtocolName("Noise_N_25519_AESGCM_SHA256")
    .build();

// -&gt; e, es (with an empty payload)
final byte[] initiatorEphemeralKeyMessage = initiatorHandshake.writeMessage((byte[]) null);
responderHandshake.readMessage(initiatorEphemeralKeyMessage);

assert initiatorHandshake.isDone();
assert responderHandshake.isDone();

final NoiseTransportWriter transportWriter = initiatorHandshake.toTransportWriter();
final NoiseTransportReader transportReader = responderHandshake.toTransportReader();
</code></pre>
</div>


 <h2 id="fallback-patterns-heading">Fallback patterns</h2>

 <p>Noise handshakes can "fall back" to another pattern to handle certain kinds of errors. As an example, the
 <a href="https://noiseprotocol.org/noise.html#noise-pipes">Noise Pipes</a> compound protocol expects that initiators
 will usually have the responder's static public key available from a previous "full" (XX) handshake, and can use an
 abbreviated (IK) handshake pattern with that static key set via a pre-handshake message. If the responder can't
 decrypt a message from the initiator, though, it might conclude that the initiator has a stale copy of its public key
 and can fall back to a "full" (XXfallback) handshake.</p>

 <p>The IK handshake pattern is defined as:</p>

 <pre>IK:
   &lt;- s
   ...
   -&gt; e, es, s, ss
   &lt;- e, ee, se</pre>

 <p>…and the XXfallback pattern is defined as:</p>

 <pre>XXfallback:
   -&gt; e
   ...
   &lt;- e, ee, s, es
   -&gt; s, se</pre>

 <p>As an example, consider a scenario where the initiator of an IK handshake has a "stale" static key for the
 responder:</p>

 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">final NoiseHandshake ikInitiatorHandshake =
    NoiseHandshakeBuilder.forIKInitiator(initiatorStaticKeyPair, staleRemoteStaticPublicKey)
        .setComponentsFromProtocolName("Noise_IK_25519_AESGCM_SHA256")
        .build();

final NoiseHandshake ikResponderHandshake =
    NoiseHandshakeBuilder.forIKResponder(currentResponderStaticKeyPair)
        .setComponentsFromProtocolName("Noise_IK_25519_AESGCM_SHA256")
        .build();
</code></pre>
</div>


 <p>The initiator sends its first message to the responder, which won't be able to decrypt the message due to the
 static key disagreement:</p>

 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">// -&gt; e, es, s, ss (with an empty payload)
final byte[] initiatorStaticKeyMessage = ikInitiatorHandshake.writeMessage((byte[]) null);

// Throws an AEADBadTagException because the initiator has a stale static key for the responder
ikResponderHandshake.readMessage(initiatorStaticKeyMessage);
</code></pre>
</div>


 <p>Rather than simply failing the handshake (assuming both the initiator and responder are expecting that a fallback
 may happen), the responder can fall back to the XXfallback pattern, reusing the ephemeral key it already received
 from the initiator as a pre-handshake message, and write a message to continue the XXfallback pattern:</p>

 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">final NoiseHandshake xxFallbackResponderHandshake =
    ikResponderHandshake.fallbackTo("XXfallback");

// &lt;- e, ee, s, es (with an empty payload)
final byte[] responderStaticKeyMessage = xxFallbackResponderHandshake.writeMessage((byte[]) null);
</code></pre>
</div>


 <p>The initiator will fail to decrypt the message from the responder:</p>

 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">// Throws an AEADBadTagException
ikInitiatorHandshake.readMessage(responderStaticKeyMessage);
</code></pre>
</div>


 <p>Like the responder, the initiator can take the decryption failure as a cue to fall back to the XXfallback pattern,
 then read the message and finish the handshake:</p>

 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">final NoiseHandshake xxFallbackInitiatorHandshake =
    ikInitiatorHandshake.fallbackTo("XXfallback");

xxFallbackInitiatorHandshake.readMessage(responderStaticKeyMessage);

final byte[] initiatorFallbackStaticKeyMessage =
    xxFallbackInitiatorHandshake.writeMessage((byte[]) null);

xxFallbackResponderHandshake.readMessage(initiatorFallbackStaticKeyMessage);

assert xxFallbackInitiatorHandshake.isDone();
assert xxFallbackResponderHandshake.isDone();
</code></pre>
</div>


 <p>Once the handshake is finished, the transition to the transport phase of the protocol continues as usual.</p></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="NamedProtocolHandshakeBuilder.html" title="class in com.eatthepath.noise"><code>NamedProtocolHandshakeBuilder</code></a></li>
<li><a href="NoiseHandshakeBuilder.html" title="class in com.eatthepath.noise"><code>NoiseHandshakeBuilder</code></a></li>
<li><a href="https://noiseprotocol.org/noise.html#payload-security-properties">The Noise Protocol Framework - Payload security proprties</a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static enum&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="NoiseHandshake.Role.html" class="type-name-link" title="enum class in com.eatthepath.noise">NoiseHandshake.Role</a></code></div>
<div class="col-last even-row-color">
<div class="block">An enumeration of roles within a Noise handshake.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="NoiseHandshake.html" title="class in com.eatthepath.noise">NoiseHandshake</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#fallbackTo(java.lang.String)" class="member-name-link">fallbackTo</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;handshakePatternName)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">"Falls back" to the named handshake pattern, transferring any appropriate static/ephemeral keys and an empty
 collection of pre-shared keys.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="NoiseHandshake.html" title="class in com.eatthepath.noise">NoiseHandshake</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#fallbackTo(java.lang.String,java.util.List)" class="member-name-link">fallbackTo</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;handshakePatternName,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;byte[]&gt;&nbsp;preSharedKeys)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">"Falls back" to the named handshake pattern, transferring any appropriate static/ephemeral keys and the given
 collection of pre-shared keys.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getHash()" class="member-name-link">getHash</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns a hash of this handshake's state that uniquely identifies the Noise session.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getNoiseProtocolName()" class="member-name-link">getNoiseProtocolName</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the full name of the Noise protocol for this handshake.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getOutboundMessageLength(int)" class="member-name-link">getOutboundMessageLength</a><wbr>(int&nbsp;payloadLength)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the length of the Noise handshake message this handshake would produce for a payload with the given length
 and with this handshake's current state.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getPayloadLength(int)" class="member-name-link">getPayloadLength</a><wbr>(int&nbsp;handshakeMessageLength)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the length of the plaintext of a payload contained in a Noise handshake message of the given length and
 with this handshake's current state.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isDone()" class="member-name-link">isDone</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Checks if this handshake has successfully exchanged all messages required by its handshake pattern.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isExpectingRead()" class="member-name-link">isExpectingRead</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Checks if this handshake is currently expecting to receive a handshake message from its peer.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isExpectingWrite()" class="member-name-link">isExpectingWrite</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Checks if this handshake is currently expecting to send a handshake message to its peer.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isOneWayHandshake()" class="member-name-link">isOneWayHandshake</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Checks whether this is a handshake for a one-way Noise handshake pattern.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readMessage(byte%5B%5D)" class="member-name-link">readMessage</a><wbr>(byte[]&nbsp;message)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Reads the next handshake message, advancing this handshake's internal state.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readMessage(byte%5B%5D,int,int,byte%5B%5D,int)" class="member-name-link">readMessage</a><wbr>(byte[]&nbsp;message,
 int&nbsp;messageOffset,
 int&nbsp;messageLength,
 byte[]&nbsp;payload,
 int&nbsp;payloadOffset)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Reads the next handshake message, writing the plaintext of the message's payload into the given array and advancing
 this handshake's internal state.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readMessage(java.nio.ByteBuffer)" class="member-name-link">readMessage</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;message)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Reads the next handshake message, advancing this handshake's internal state.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readMessage(java.nio.ByteBuffer,java.nio.ByteBuffer)" class="member-name-link">readMessage</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;message,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;payload)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Reads the next handshake message, writing the plaintext of the message's payload into the given buffer and
 advancing this handshake's internal state.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="NoiseTransport.html" title="interface in com.eatthepath.noise">NoiseTransport</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toTransport()" class="member-name-link">toTransport</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Builds a interactive Noise transport object from this handshake.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="NoiseTransportReader.html" title="interface in com.eatthepath.noise">NoiseTransportReader</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toTransportReader()" class="member-name-link">toTransportReader</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Builds a read-only Noise transport object from this handshake.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="NoiseTransportWriter.html" title="interface in com.eatthepath.noise">NoiseTransportWriter</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toTransportWriter()" class="member-name-link">toTransportWriter</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Builds a write-only Noise transport object from this handshake.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#writeMessage(byte%5B%5D)" class="member-name-link">writeMessage</a><wbr>(byte[]&nbsp;payload)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Writes the next Noise handshake message for this handshake instance, advancing this handshake's internal state.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#writeMessage(byte%5B%5D,int,int,byte%5B%5D,int)" class="member-name-link">writeMessage</a><wbr>(byte[]&nbsp;payload,
 int&nbsp;payloadOffset,
 int&nbsp;payloadLength,
 byte[]&nbsp;message,
 int&nbsp;messageOffset)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Writes the next Noise handshake message for this handshake instance into the given array, advancing this
 handshake's internal state.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#writeMessage(java.nio.ByteBuffer)" class="member-name-link">writeMessage</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;payload)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Writes the next Noise handshake message for this handshake instance, advancing this handshake's internal state.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#writeMessage(java.nio.ByteBuffer,java.nio.ByteBuffer)" class="member-name-link">writeMessage</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;payload,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;message)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Writes the next Noise handshake message for this handshake instance into the given buffer, advancing this
 handshake's internal state.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="getNoiseProtocolName()">
<h3>getNoiseProtocolName</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">getNoiseProtocolName</span>()</div>
<div class="block">Returns the full name of the Noise protocol for this handshake.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the full name of the Noise protocol for this handshake</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="https://noiseprotocol.org/noise.html#protocol-names-and-modifiers">The Noise Protocol Framework - Protocol names and modifiers</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isOneWayHandshake()">
<h3>isOneWayHandshake</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isOneWayHandshake</span>()</div>
<div class="block">Checks whether this is a handshake for a one-way Noise handshake pattern.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd><code>true</code> if this is a handshake for a one-way Noise handshake pattern or <code>false</code> if this is a
 handshake for a interactive Noise handshake pattern</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isExpectingRead()">
<h3>isExpectingRead</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isExpectingRead</span>()</div>
<div class="block">Checks if this handshake is currently expecting to receive a handshake message from its peer.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd><code>true</code> if this handshake is expecting to receive a handshake message from its peer as its next action
 or <code>false</code> if this handshake is done or is expecting to send a handshake message to its peer as its next
 action</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#isExpectingWrite()"><code>isExpectingWrite()</code></a></li>
<li><a href="#isDone()"><code>isDone()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isExpectingWrite()">
<h3>isExpectingWrite</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isExpectingWrite</span>()</div>
<div class="block">Checks if this handshake is currently expecting to send a handshake message to its peer.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd><code>true</code> if this handshake is expecting to send a handshake message to its peer as its next action or
 <code>false</code> if this handshake is done or is expecting to receive a handshake message from its peer as its next
 action</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#isExpectingRead()"><code>isExpectingRead()</code></a></li>
<li><a href="#isDone()"><code>isDone()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isDone()">
<h3>isDone</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isDone</span>()</div>
<div class="block">Checks if this handshake has successfully exchanged all messages required by its handshake pattern.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd><code>true</code> if all required messages have been exchanged or <code>false</code> if more exchanges are required</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#isExpectingRead()"><code>isExpectingRead()</code></a></li>
<li><a href="#isExpectingWrite()"><code>isExpectingWrite()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getOutboundMessageLength(int)">
<h3>getOutboundMessageLength</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">getOutboundMessageLength</span><wbr><span class="parameters">(int&nbsp;payloadLength)</span></div>
<div class="block">Returns the length of the Noise handshake message this handshake would produce for a payload with the given length
 and with this handshake's current state.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>payloadLength</code> - the length of a payload's plaintext</dd>
<dt>Returns:</dt>
<dd>the length of the message this handshake would produce for a payload with the given length</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this handshake is not currently expecting to send a message to its peer</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getPayloadLength(int)">
<h3>getPayloadLength</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">getPayloadLength</span><wbr><span class="parameters">(int&nbsp;handshakeMessageLength)</span></div>
<div class="block">Returns the length of the plaintext of a payload contained in a Noise handshake message of the given length and
 with this handshake's current state.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>handshakeMessageLength</code> - the length of a Noise handshake message received from this party's peer</dd>
<dt>Returns:</dt>
<dd>the length of the plaintext of a payload contained in a handshake message of the given length</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this handshake is not currently expecting to receive a message from its peer</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if the given handshake message length shorter than the minimum expected length of
 an incoming handshake message</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="writeMessage(byte[])">
<h3>writeMessage</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">writeMessage</span><wbr><span class="parameters">(@Nullable
 byte[]&nbsp;payload)</span></div>
<div class="block"><p>Writes the next Noise handshake message for this handshake instance, advancing this handshake's internal state.
 The returned message will include any key material specified by this handshake's current message pattern and either
 the plaintext or a ciphertext of the given payload.</p>

 <p>Note that the security properties for the optional payload vary by handshake pattern, message, and sender role.
 Callers are responsible for verifying that the security properties associated with ny handshake message are
 suitable for their use case.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>payload</code> - the payload to include in this handshake message; may be <code>null</code></dd>
<dt>Returns:</dt>
<dd>a new byte array containing the resulting handshake message</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if the message produced for the given payload would be larger than the maximum
 allowed Noise handshake message size</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this handshake is not currently expecting to send a handshake message to its peer</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#isExpectingWrite()"><code>isExpectingWrite()</code></a></li>
<li><a href="https://noiseprotocol.org/noise.html#payload-security-properties">The Noise Protocol Framework - Payload security properties</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="writeMessage(byte[],int,int,byte[],int)">
<h3>writeMessage</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">writeMessage</span><wbr><span class="parameters">(@Nullable
 byte[]&nbsp;payload,
 int&nbsp;payloadOffset,
 int&nbsp;payloadLength,
 byte[]&nbsp;message,
 int&nbsp;messageOffset)</span>
                 throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/ShortBufferException.html" title="class or interface in javax.crypto" class="external-link">ShortBufferException</a></span></div>
<div class="block"><p>Writes the next Noise handshake message for this handshake instance into the given array, advancing this
 handshake's internal state. The resulting message will include any key material specified by this handshake's
 current message pattern and either the plaintext or a ciphertext of the given payload.</p>

 <p>Note that the security properties for the optional payload vary by handshake pattern, message, and sender role.
 Callers are responsible for verifying that the security properties associated with ny handshake message are
 suitable for their use case.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>payload</code> - a byte array containing the optional payload for this handshake message; may be <code>null</code></dd>
<dd><code>payloadOffset</code> - the offset within <code>payload</code> where the payload begins; ignored if <code>payload</code> is
 <code>null</code></dd>
<dd><code>payloadLength</code> - the length of the payload within <code>payload</code></dd>
<dd><code>message</code> - a byte array into which to write the resulting handshake message</dd>
<dd><code>messageOffset</code> - the position within <code>message</code> at which to begin writing the handshake message</dd>
<dt>Returns:</dt>
<dd>the number of bytes written to <code>message</code></dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if the message produced for the given payload would be larger than the maximum
 allowed Noise handshake message size</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this handshake is not currently expecting to send a handshake message to its peer</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/ShortBufferException.html" title="class or interface in javax.crypto" class="external-link">ShortBufferException</a></code> - if <code>message</code> is not large enough (after its offset) to hold the handshake
 message</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#isExpectingWrite()"><code>isExpectingWrite()</code></a></li>
<li><a href="#getOutboundMessageLength(int)"><code>getOutboundMessageLength(int)</code></a></li>
<li><a href="https://noiseprotocol.org/noise.html#payload-security-properties">The Noise Protocol Framework -
 Payload security properties</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="writeMessage(java.nio.ByteBuffer)">
<h3>writeMessage</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a></span>&nbsp;<span class="element-name">writeMessage</span><wbr><span class="parameters">(@Nullable
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;payload)</span></div>
<div class="block"><p>Writes the next Noise handshake message for this handshake instance, advancing this handshake's internal state.
 The returned message will include any key material specified by this handshake's current message pattern and either
 the plaintext or a ciphertext of the given payload.</p>

 <p>Note that the security properties for the optional payload vary by handshake pattern, message, and sender role.
 Callers are responsible for verifying that the security properties associated with ny handshake message are
 suitable for their use case.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>payload</code> - the payload to include in this handshake message; may be <code>null</code></dd>
<dt>Returns:</dt>
<dd>a new byte buffer containing the resulting handshake message</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if the message produced for the given payload would be larger than the maximum
 allowed Noise handshake message size</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this handshake is not currently expecting to send a handshake message to its peer</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#isExpectingWrite()"><code>isExpectingWrite()</code></a></li>
<li><a href="https://noiseprotocol.org/noise.html#payload-security-properties">The Noise Protocol Framework - Payload security properties</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="writeMessage(java.nio.ByteBuffer,java.nio.ByteBuffer)">
<h3>writeMessage</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">writeMessage</span><wbr><span class="parameters">(@Nullable
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;payload,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;message)</span>
                 throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/ShortBufferException.html" title="class or interface in javax.crypto" class="external-link">ShortBufferException</a></span></div>
<div class="block"><p>Writes the next Noise handshake message for this handshake instance into the given buffer, advancing this
 handshake's internal state. The resulting message will include any key material specified by this handshake's
 current message pattern and either the plaintext or a ciphertext of the given payload.</p>

 <p>Note that the security properties for the optional payload vary by handshake pattern, message, and sender role.
 Callers are responsible for verifying that the security properties associated with ny handshake message are
 suitable for their use case.</p>

 <p>If provided, all <code>payload.remaining()</code> bytes starting at <code>payload.position()</code> are processed. Upon
 return, the payload buffer's position will be equal to its limit; its limit will not have changed. The message
 buffer's position will have advanced by n, where n is the value returned by this method; the message buffer's limit
 will not have changed.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>payload</code> - a byte buffer containing the optional payload for this handshake message; may be <code>null</code></dd>
<dd><code>message</code> - a byte buffer into which to write the resulting handshake message</dd>
<dt>Returns:</dt>
<dd>the number of bytes written to <code>message</code></dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if the message produced for the given payload would be larger than the maximum
 allowed Noise handshake message size</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this handshake is not currently expecting to send a handshake message to its peer</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/ShortBufferException.html" title="class or interface in javax.crypto" class="external-link">ShortBufferException</a></code> - if <code>message</code> does not have enough remaining capacity to hold the handshake
 message</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#isExpectingWrite()"><code>isExpectingWrite()</code></a></li>
<li><a href="#getOutboundMessageLength(int)"><code>getOutboundMessageLength(int)</code></a></li>
<li><a href="https://noiseprotocol.org/noise.html#payload-security-properties">The Noise Protocol Framework -
 Payload security properties</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="readMessage(byte[])">
<h3>readMessage</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">readMessage</span><wbr><span class="parameters">(byte[]&nbsp;message)</span>
                   throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/AEADBadTagException.html" title="class or interface in javax.crypto" class="external-link">AEADBadTagException</a></span></div>
<div class="block">Reads the next handshake message, advancing this handshake's internal state.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>message</code> - the handshake message to read</dd>
<dt>Returns:</dt>
<dd>a byte array containing the plaintext of the payload included in the handshake message; may be empty</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/AEADBadTagException.html" title="class or interface in javax.crypto" class="external-link">AEADBadTagException</a></code> - if the AEAD tag for any encrypted component of the given handshake message does not
 match the calculated value</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if the given message is too short to contain the expected handshake message or if
 the given message is larger than the maximum allowed Noise handshake message size</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="readMessage(byte[],int,int,byte[],int)">
<h3>readMessage</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">readMessage</span><wbr><span class="parameters">(byte[]&nbsp;message,
 int&nbsp;messageOffset,
 int&nbsp;messageLength,
 byte[]&nbsp;payload,
 int&nbsp;payloadOffset)</span>
                throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/ShortBufferException.html" title="class or interface in javax.crypto" class="external-link">ShortBufferException</a>,
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/AEADBadTagException.html" title="class or interface in javax.crypto" class="external-link">AEADBadTagException</a></span></div>
<div class="block">Reads the next handshake message, writing the plaintext of the message's payload into the given array and advancing
 this handshake's internal state.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>message</code> - a byte array containing the handshake message to read</dd>
<dd><code>messageOffset</code> - the position within <code>message</code> at which the handshake message begins</dd>
<dd><code>messageLength</code> - the length of the handshake message within <code>message</code></dd>
<dd><code>payload</code> - a byte array into which to write the plaintext of the payload included in the given handshake
 message</dd>
<dd><code>payloadOffset</code> - the position within <code>payload</code> at which to begin writing the payload</dd>
<dt>Returns:</dt>
<dd>a byte array containing the plaintext of the payload included in the handshake message; may be empty</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/AEADBadTagException.html" title="class or interface in javax.crypto" class="external-link">AEADBadTagException</a></code> - if the AEAD tag for any encrypted component of the given handshake message does not
 match the calculated value</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/ShortBufferException.html" title="class or interface in javax.crypto" class="external-link">ShortBufferException</a></code> - if <code>payload</code> is too short (after its offset) to hold the plaintext of the
 payload included in the given handshake message</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if the given message is too short to contain the expected handshake message or if
 the given message is larger than the maximum allowed Noise handshake message size</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#getPayloadLength(int)"><code>getPayloadLength(int)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="readMessage(java.nio.ByteBuffer)">
<h3>readMessage</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a></span>&nbsp;<span class="element-name">readMessage</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;message)</span>
                       throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/AEADBadTagException.html" title="class or interface in javax.crypto" class="external-link">AEADBadTagException</a></span></div>
<div class="block">Reads the next handshake message, advancing this handshake's internal state.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>message</code> - the handshake message to read</dd>
<dt>Returns:</dt>
<dd>a new byte buffer containing the plaintext of the payload included in the handshake message; may be empty</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/AEADBadTagException.html" title="class or interface in javax.crypto" class="external-link">AEADBadTagException</a></code> - if the AEAD tag for any encrypted component of the given handshake message does not
 match the calculated value</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if the given message is too short to contain the expected handshake message or if
 the given message is larger than the maximum allowed Noise handshake message size</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="readMessage(java.nio.ByteBuffer,java.nio.ByteBuffer)">
<h3>readMessage</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">readMessage</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;message,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;payload)</span>
                throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/ShortBufferException.html" title="class or interface in javax.crypto" class="external-link">ShortBufferException</a>,
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/AEADBadTagException.html" title="class or interface in javax.crypto" class="external-link">AEADBadTagException</a></span></div>
<div class="block"><p>Reads the next handshake message, writing the plaintext of the message's payload into the given buffer and
 advancing this handshake's internal state.</p>

 <p>All <code>message.remaining()</code> bytes starting at <code>message.position()</code> are processed. Upon return,
 the message buffer's position will be equal to its limit; its limit will not have changed. The payload buffer's
 position will have advanced by n, where n is the value returned by this method; the payload buffer's limit will not
 have changed.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>message</code> - a byte buffer containing the handshake message to read</dd>
<dd><code>payload</code> - a byte buffer into which to write the plaintext of the payload included in the given handshake
 message</dd>
<dt>Returns:</dt>
<dd>the number of bytes written to <code>payload</code></dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/AEADBadTagException.html" title="class or interface in javax.crypto" class="external-link">AEADBadTagException</a></code> - if the AEAD tag for any encrypted component of the given handshake message does not
 match the calculated value</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/crypto/ShortBufferException.html" title="class or interface in javax.crypto" class="external-link">ShortBufferException</a></code> - if <code>payload</code> does not have enough remaining capacity to hold the plaintext of
 the payload included in the given handshake message</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if the given message is too short to contain the expected handshake message or if
 the given message is larger than the maximum allowed Noise handshake message size</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#getPayloadLength(int)"><code>getPayloadLength(int)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="fallbackTo(java.lang.String)">
<h3>fallbackTo</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="NoiseHandshake.html" title="class in com.eatthepath.noise">NoiseHandshake</a></span>&nbsp;<span class="element-name">fallbackTo</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;handshakePatternName)</span>
                          throws <span class="exceptions"><a href="NoSuchPatternException.html" title="class in com.eatthepath.noise">NoSuchPatternException</a></span></div>
<div class="block">"Falls back" to the named handshake pattern, transferring any appropriate static/ephemeral keys and an empty
 collection of pre-shared keys.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>handshakePatternName</code> - the name of the handshake pattern to which to fall back; must be a pattern with a
                             "fallback" modifier</dd>
<dt>Returns:</dt>
<dd>a new Noise handshake instance that implements the given fallback handshake pattern</dd>
<dt>Throws:</dt>
<dd><code><a href="NoSuchPatternException.html" title="class in com.eatthepath.noise">NoSuchPatternException</a></code> - if the given fallback pattern name is not a recognized Noise handshake pattern name
 or cannot be derived from a recognized Noise handshake pattern</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if the given fallback pattern name is not a fallback pattern</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if the given fallback pattern requires key material not available to the current
 handshake</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="https://noiseprotocol.org/noise.html#the-fallback-modifier">The Noise Protocol Framework - The fallback modifier</a></li>
<li><code>HandshakePattern.isFallbackPattern()</code></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="fallbackTo(java.lang.String,java.util.List)">
<h3>fallbackTo</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="NoiseHandshake.html" title="class in com.eatthepath.noise">NoiseHandshake</a></span>&nbsp;<span class="element-name">fallbackTo</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;handshakePatternName,
 @Nullable
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;byte[]&gt;&nbsp;preSharedKeys)</span>
                          throws <span class="exceptions"><a href="NoSuchPatternException.html" title="class in com.eatthepath.noise">NoSuchPatternException</a></span></div>
<div class="block">"Falls back" to the named handshake pattern, transferring any appropriate static/ephemeral keys and the given
 collection of pre-shared keys.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>handshakePatternName</code> - the name of the handshake pattern to which to fall back; must be a pattern with a
                             "fallback" modifier</dd>
<dd><code>preSharedKeys</code> - the pre-shared keys to use in the fallback handshake; may be <code>null</code></dd>
<dt>Returns:</dt>
<dd>a new Noise handshake instance that implements the given fallback handshake pattern</dd>
<dt>Throws:</dt>
<dd><code><a href="NoSuchPatternException.html" title="class in com.eatthepath.noise">NoSuchPatternException</a></code> - if the given fallback pattern name is not a recognized Noise handshake pattern name
 or cannot be derived from a recognized Noise handshake pattern</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if the given fallback pattern name is not a fallback pattern</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if the given fallback pattern requires key material not available to the current
 handshake</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="https://noiseprotocol.org/noise.html#the-fallback-modifier">The Noise Protocol Framework - The fallback modifier</a></li>
<li><code>HandshakePattern.isFallbackPattern()</code></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toTransport()">
<h3>toTransport</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="NoiseTransport.html" title="interface in com.eatthepath.noise">NoiseTransport</a></span>&nbsp;<span class="element-name">toTransport</span>()</div>
<div class="block">Builds a interactive Noise transport object from this handshake. This method may be called exactly once, only if
 this is a interactive (i.e. not one-way) handshake, and only when the handshake is done.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>a interactive Noise transport object derived from this completed handshake</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this is a one-way handshake, the handshake has not finished, or this handshake has
 previously been "split" into a Noise transport object</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#isDone()"><code>isDone()</code></a></li>
<li><a href="#isOneWayHandshake()"><code>isOneWayHandshake()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toTransportReader()">
<h3>toTransportReader</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="NoiseTransportReader.html" title="interface in com.eatthepath.noise">NoiseTransportReader</a></span>&nbsp;<span class="element-name">toTransportReader</span>()</div>
<div class="block">Builds a read-only Noise transport object from this handshake. This method may be called exactly once, only if
 this is a one-way handshake, only if this is the handshake for the responder, and only when the handshake is done.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>a read-only Noise transport object derived from this completed handshake</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this is not a one-way handshake, if this method is called on the initiator side
 of a one-way handshake, if the handshake has not finished, or this handshake has previously been "split" into a
 Noise transport object</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#isDone()"><code>isDone()</code></a></li>
<li><a href="#isOneWayHandshake()"><code>isOneWayHandshake()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toTransportWriter()">
<h3>toTransportWriter</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="NoiseTransportWriter.html" title="interface in com.eatthepath.noise">NoiseTransportWriter</a></span>&nbsp;<span class="element-name">toTransportWriter</span>()</div>
<div class="block">Builds a write-only Noise transport object from this handshake. This method may be called exactly once, only if
 this is a one-way handshake, only if this is the handshake for the initiator, and only when the handshake is done.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>a read-only Noise transport object derived from this completed handshake</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this is not a one-way handshake, if this method is called on the responder side
 of a one-way handshake, if the handshake has not finished, or this handshake has previously been "split" into a
 Noise transport object</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#isDone()"><code>isDone()</code></a></li>
<li><a href="#isOneWayHandshake()"><code>isOneWayHandshake()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getHash()">
<h3>getHash</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">getHash</span>()</div>
<div class="block">Returns a hash of this handshake's state that uniquely identifies the Noise session. May only be called once the
 handshake has been transformed into a transport instance.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>a hash of this handshake's state that uniquely identifies the Noise session</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this handshake instance has not yet be transformed into a transport instance</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="https://noiseprotocol.org/noise.html#channel-binding">The Noise Protocol Framework - Channel binding</a></li>
<li><a href="#toTransport()"><code>toTransport()</code></a></li>
<li><a href="#toTransportReader()"><code>toTransportReader()</code></a></li>
<li><a href="#toTransportWriter()"><code>toTransportWriter()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2024. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
